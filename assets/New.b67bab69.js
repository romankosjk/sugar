var t=Object.assign;import{d as e,p as o,e as a,o as r,c as s,a as c,F as i,f as n,t as d,g as l,h as u,l as p,v as h,m,w as f,b}from"./vendor.7c5eae7b.js";const y=new PouchDB("product"),g=new PouchDB("category");var _=e({name:"New",setup:()=>{},data:()=>({isSync:!1,product:{title:"",category_id:0,product_b:"",product_j:"",product_y:"",image:null,gram:100,is_home:0,variable_1:"",variable_2:"",variable_3:"",variable_4:"",variable_5:""},category:{title:""},products:[],categories:[],dbProducts:[],dbCategories:[]}),computed:{},methods:{randomInteger:(t=1e5,e=1e9)=>Math.floor(Math.random()*(e-t+1))+t,resizeImage:(t,e=100,o=100)=>new Promise((a=>{let r=new Image;r.src=t,r.onload=()=>{let t=document.createElement("canvas");const s=e,c=o;let i=r.width,n=r.height;i>n?i>s&&(n*=s/i,i=s):n>c&&(i*=c/n,n=c),t.width=i,t.height=n,t.getContext("2d").drawImage(r,0,0,i,n),a(t.toDataURL())}})),getBase64:t=>new Promise((function(e,o){let a=new FileReader;a.readAsDataURL(t),a.onload=()=>e(a.result),a.onerror=t=>o("Error: ",t)})),onChange(t){const e=this;this.getBase64(t.target.files[0]).then((t=>{e.resizeImage(t).then((t=>{e.product.image=t,console.log(t)}))}))},onDefault(){this.category.title=""},async saveProductPouchDB(e){try{await y.put(t({_id:e},this.product)).then((()=>{this.product.title="",this.product.category_id=0,this.product.product_b="",this.product.product_j="",this.product.product_y="",this.product.image=null}))}catch(o){console.error(o)}},async saveCategoryPouchDB(e){try{await g.put(t({_id:e},this.category)).then((()=>{this.category.title=""}))}catch(o){console.error(o)}},async saveFireDb(e){e.preventDefault();const o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t({_id:this.randomInteger().toString()},this.category))},a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t({_id:this.randomInteger().toString()},this.product))};try{this.category.title?await fetch("https://test-aac6c.firebaseio.com/category.json",o).then((t=>t.json())).then((e=>{this.updateCategoryFireDb(e.name),this.saveCategoryPouchDB(e.name),this.product.category_id=e.name;const o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t({_id:this.randomInteger().toString()},this.product))};fetch("https://test-aac6c.firebaseio.com/product.json",o).then((t=>t.json())).then((t=>{this.updateProductFireDb(t.name),this.saveProductPouchDB(t.name)}))})):await fetch("https://test-aac6c.firebaseio.com/product.json",a).then((t=>t.json())).then((t=>{this.updateProductFireDb(t.name),this.saveProductPouchDB(t.name)}))}catch(r){console.error(r)}},async updateProductFireDb(t){const e={method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t})};try{await fetch(`https://test-aac6c.firebaseio.com/product/${t}.json`,e)}catch(o){console.error(o)}},async updateCategoryFireDb(t){const e={method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({_id:t})};try{await fetch(`https://test-aac6c.firebaseio.com/category/${t}.json`,e)}catch(o){console.error(o)}},async getCategories(){try{await g.allDocs({include_docs:!0,attachments:!0}).then((t=>{this.categories=t.rows}))}catch(t){console.error(t)}},async onSync(){await fetch("https://test-aac6c.firebaseio.com/product.json").then((t=>t.json())).then((t=>{this.dbProducts=t})),await fetch("https://test-aac6c.firebaseio.com/category.json").then((t=>t.json())).then((t=>{this.dbCategories=t}))},async addStoreProducts(t){y.put(t)},async addStoreCategories(t){g.put(t)}},mounted(){this.getCategories()}});const v=f("data-v-051c5225");o("data-v-051c5225");const C={class:"product"},P={class:"d-none"},w={key:0},j={key:1},D={class:"product-container d-flex mb-2"},x={class:"product-container__avatar me-2"},S={class:"product-container__information text-center w-100 d-flex flex-column"},B={class:"text-center h6 text-primary"},F=b(" На "),T=c("strong",null,"100",-1),I=b(" гр. продукту "),O={class:"information-items d-flex mt-auto"},U={class:"information flex-fill d-flex flex-column"},k=c("span",{class:"information__header"},"Б",-1),N={class:"information__footer"},A={class:"information flex-fill d-flex flex-column"},V=c("span",{class:"information__header"},"Ж",-1),q={class:"information__footer"},J={class:"information flex-fill d-flex flex-column"},H=c("span",{class:"information__header"},"У",-1),R={class:"information__footer"},z={class:"product-form"},E={class:"mb-3"},L=c("label",{for:"productName",class:"form-label"},"Название продукту",-1),M={class:"mb-3"},Y=c("label",{class:"form-label"},"Иснуюча категоря",-1),$=c("option",{value:"0",selected:""},"-- Нету ---",-1),G={class:"mb-3"},K=c("label",{for:"productCategory",class:"form-label"},"Нова категория",-1),Q={class:"row mb-3"},W={class:"col-6"},X=c("label",{for:"productB",class:"form-label"},"Белков на 100гр.",-1),Z={class:"col-6"},tt=c("label",{for:"productH",class:"form-label"},"Жиров на 100гр.",-1),et={class:"mb-3"},ot=c("label",{for:"productY",class:"form-label"},"Углеводов на 100гр.",-1),at={class:"mb-3"},rt=c("label",{for:"productAvatar",class:"form-label"},"Картинка",-1),st=c("button",{type:"submit",class:"btn btn-primary btn-lg w-100"},"Добавить",-1);a();const ct=v(((t,e,o,a,f,b)=>(r(),s("div",C,[c("div",P,[t.dbProducts?(r(),s("div",w,[(r(!0),s(i,null,n(t.dbProducts,((e,o)=>(r(),s("div",{key:o},d(t.addStoreProducts(e)),1)))),128))])):l("",!0),t.dbProducts?(r(),s("div",j,[t.dbCategories?(r(!0),s(i,{key:0},n(t.dbCategories,((e,o)=>(r(),s("div",{key:o},d(t.addStoreCategories(e)),1)))),128)):l("",!0)])):l("",!0)]),c("div",D,[c("div",x,[t.product.image?(r(),s("img",{key:0,class:"mx-auto",src:t.product.image},null,8,["src"])):l("",!0)]),c("div",S,[c("p",B,[F,T,I,c("a",{href:"#",class:"btn btn-warning btn-sm ms-2",disabled:t.isSync,onClick:e[1]||(e[1]=u(((...e)=>t.onSync&&t.onSync(...e)),["prevent"]))},"Sinc",8,["disabled"])]),c("div",O,[c("div",U,[k,c("span",N,d(t.product.product_b||"0"),1)]),c("div",A,[V,c("span",q,d(t.product.product_j||"0"),1)]),c("div",J,[H,c("span",R,d(t.product.product_y||"0"),1)])])])]),c("div",z,[c("form",{onSubmit:e[10]||(e[10]=(...e)=>t.saveFireDb&&t.saveFireDb(...e))},[c("div",E,[L,p(c("input",{"onUpdate:modelValue":e[2]||(e[2]=e=>t.product.title=e),type:"text",class:"form-control",id:"productName",placeholder:""},null,512),[[h,t.product.title]])]),c("div",M,[Y,p(c("select",{onChange:e[3]||(e[3]=(...e)=>t.onDefault&&t.onDefault(...e)),"onUpdate:modelValue":e[4]||(e[4]=e=>t.product.category_id=e),class:"form-select","aria-label":"Default select example"},[$,(r(!0),s(i,null,n(t.categories,((t,e)=>(r(),s("option",{value:t.id,key:e},d(t.doc.title),9,["value"])))),128))],544),[[m,t.product.category_id]])]),c("div",G,[K,p(c("input",{required:!t.product.category_id,"onUpdate:modelValue":e[5]||(e[5]=e=>t.category.title=e),type:"text",class:"form-control",id:"productCategory",placeholder:""},null,8,["required"]),[[h,t.category.title]])]),c("div",Q,[c("div",W,[X,p(c("input",{required:"","onUpdate:modelValue":e[6]||(e[6]=e=>t.product.product_b=e),type:"number",step:"0.1",class:"form-control",id:"productB",placeholder:""},null,512),[[h,t.product.product_b]])]),c("div",Z,[tt,p(c("input",{required:"","onUpdate:modelValue":e[7]||(e[7]=e=>t.product.product_j=e),type:"number",step:"0.1",class:"form-control",id:"productH",placeholder:""},null,512),[[h,t.product.product_j]])])]),c("div",et,[ot,p(c("input",{required:"","onUpdate:modelValue":e[8]||(e[8]=e=>t.product.product_y=e),type:"number",step:"0.1",class:"form-control",id:"productY",placeholder:""},null,512),[[h,t.product.product_y]])]),c("div",at,[rt,c("input",{onChange:e[9]||(e[9]=(...e)=>t.onChange&&t.onChange(...e)),type:"file",class:"form-control",id:"productAvatar","aria-describedby":"productAvatar","aria-label":"Upload"},null,32)]),st],32)])]))));_.render=ct,_.__scopeId="data-v-051c5225";export default _;
