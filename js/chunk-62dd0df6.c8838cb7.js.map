{"version":3,"sources":["webpack:///./src/pages/Category/CategoryEdit.vue?b62a","webpack:///./src/pages/Category/CategoryEdit.vue?023e","webpack:///src/pages/Category/CategoryEdit.vue","webpack:///./src/pages/Category/CategoryEdit.vue?e953","webpack:///./src/pages/Category/CategoryEdit.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","categories","staticClass","_l","item","index","key","directives","name","rawName","value","doc","expression","attrs","domProps","on","$event","saveCategory","target","composing","$set","ref","refInFor","showWarning","model","callback","$$v","modalShow","_v","onClose","removeCategoryLocal","_e","staticRenderFns","data","rev","remove","removeIndex","computed","isOnline","window","navigator","onLine","methods","mounted","getCategories","component"],"mappings":"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","file":"js/chunk-62dd0df6.c8838cb7.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CategoryEdit.vue?vue&type=style&index=0&id=068929a2&scoped=true&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.categories.length)?_c('div',{staticClass:\"category-items text-center\"},[_vm._l((_vm.categories),function(item,index){return _c('div',{key:index,staticClass:\"d-block card category-items__item text-decoration-none mb-2\"},[_c('div',{staticClass:\"card-body d-flex\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(item.doc.title),expression:\"item.doc.title\"}],staticClass:\"form-control\",attrs:{\"type\":\"text\",\"placeholder\":\"\"},domProps:{\"value\":(item.doc.title)},on:{\"keyup\":function($event){return _vm.saveCategory(item.doc, index)},\"input\":function($event){if($event.target.composing){ return; }_vm.$set(item.doc, \"title\", $event.target.value)}}}),_c('div',{staticClass:\"ml-2\"},[_c('b-button',{ref:\"button\",refInFor:true,staticClass:\"d-flex align-items-center\",attrs:{\"variant\":\"danger\"},on:{\"click\":function($event){return _vm.showWarning(item.doc, index)}}},[_c('b-icon',{attrs:{\"icon\":\"x-circle\",\"aria-hidden\":\"true\"}})],1)],1)])])}),_c('b-modal',{attrs:{\"centered\":\"\",\"hide-footer\":\"\",\"hide-header\":\"\"},model:{value:(_vm.modalShow),callback:function ($$v) {_vm.modalShow=$$v},expression:\"modalShow\"}},[_c('div',{staticClass:\"d-block text-center\"},[_c('h5',{staticClass:\"mb-2\"},[_vm._v(\"Вы уверены что хотите удалить Категорию\")]),_c('p',[_c('b',[_vm._v(\"Важно!!!\")]),_vm._v(\" Категория должна быть пуста, иначе все продукты что в ней находятся пропадут!!!\")])]),_c('div',{staticClass:\"d-flex\"},[_c('b-button',{staticClass:\"mr-2 w-100\",attrs:{\"size\":\"sm\",\"variant\":\"danger\"},on:{\"click\":_vm.onClose}},[_vm._v(\"Нет\")]),_c('b-button',{staticClass:\"w-100\",attrs:{\"size\":\"sm\",\"variant\":\"primary\"},on:{\"click\":_vm.removeCategoryLocal}},[_vm._v(\"Да\")])],1)])],2):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"category-items text-center\" v-if=\"categories.length\">\r\n\r\n    <div v-for=\"(item, index) in categories\" :key=\"index\" class=\"d-block card category-items__item text-decoration-none mb-2\">\r\n      <div class=\"card-body d-flex\">\r\n        <input v-model=\"item.doc.title\" @keyup=\"saveCategory(item.doc, index)\" type=\"text\" class=\"form-control\" placeholder=\"\">\r\n        <div class=\"ml-2\">\r\n          <b-button class=\"d-flex align-items-center\" variant=\"danger\" ref=\"button\" @click=\"showWarning(item.doc, index)\">\r\n            <b-icon icon=\"x-circle\" aria-hidden=\"true\"></b-icon>\r\n          </b-button>\r\n        </div>\r\n\r\n\r\n      </div>\r\n    </div>\r\n    <b-modal v-model=\"modalShow\" centered hide-footer hide-header>\r\n      <div class=\"d-block text-center\">\r\n        <h5 class=\"mb-2\">Вы уверены что хотите удалить Категорию</h5>\r\n        <p><b>Важно!!!</b> Категория должна быть пуста, иначе все продукты что в ней находятся пропадут!!!</p>\r\n      </div>\r\n      <div class=\"d-flex\">\r\n        <b-button @click=\"onClose\" size=\"sm\" variant=\"danger\" class=\"mr-2 w-100\">Нет</b-button>\r\n        <b-button @click=\"removeCategoryLocal\" size=\"sm\" variant=\"primary\" class=\"w-100\">Да</b-button>\r\n      </div>\r\n    </b-modal>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'CategoryEdit',\r\n  data() {\r\n    return {\r\n      categories: [],\r\n      modalShow: false,\r\n      rev: 0,\r\n      remove: {},\r\n      removeIndex: 0\r\n    }\r\n  },\r\n  computed: {\r\n    isOnline() {\r\n      return window.navigator.onLine;\r\n    },\r\n  },\r\n  methods: {\r\n    //set DB\r\n    async setCategoryPouchFB(id, title) {\r\n      try {\r\n        await this.$firebase.database().ref().child(`category/${id}`).update({\r\n          _id: id,\r\n          title: title,\r\n        });\r\n      } catch (error) {\r\n        console.error(error)\r\n      }\r\n    },\r\n    async getCategories() {\r\n      try {\r\n        await this.$pouch.allDocs({\r\n          include_docs: true,\r\n          attachments: true\r\n        }, 'category').then((res) => {\r\n          console.log(res.rows);\r\n          this.categories = res.rows\r\n        });\r\n      } catch (error) {\r\n        console.error(error)\r\n      }\r\n    },\r\n    async saveCategory(item, index) {\r\n      try {\r\n        if (item.title) {\r\n          await this.$pouch.put({\r\n            title: item.title,\r\n            _id: item._id,\r\n            _rev: item._rev\r\n          }, {}, 'category').then((res) => {\r\n            if (this.isOnline) {\r\n             this.categories[index].doc._rev = res.rev\r\n             //this.rev = res.rev;\r\n             this.setCategoryPouchFB(res.id, item.title)\r\n            }\r\n          });\r\n        }\r\n      } catch (error) {\r\n        console.error(error)\r\n      }\r\n      //console.log(item);\r\n    },\r\n    //remove\r\n    async removeProductFB() {\r\n      try {\r\n        await this.$firebase.database().ref().child(`product/${this.remove._id}`).remove()\r\n      } catch (error) {\r\n        console.error(error)\r\n      }\r\n    },\r\n    showWarning(item, index) {\r\n      this.modalShow = true;\r\n      this.remove = item;\r\n      this.removeIndex = index;\r\n    },\r\n\r\n    async removeCategoryLocal() {\r\n      try {\r\n        await this.$pouch.remove({\r\n          _id: this.remove._id,\r\n          _rev: this.remove._rev\r\n        }, {}, 'category').then(() => {\r\n          if (this.isOnline) {\r\n            this.removeProductFB().then(() => {})\r\n          }\r\n          this.modalShow = false;\r\n          this.categories.splice(this.removeIndex, 1);\r\n        }).catch(function (err) {\r\n          console.log(err);\r\n        });\r\n      } catch (error) {\r\n        console.error(error)\r\n      }\r\n    },\r\n    onClose() {\r\n      this.modalShow = false\r\n    },\r\n  },\r\n  mounted() {\r\n    this.getCategories();\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.category-items {\r\n  &__item {\r\n    color: #0f5132;\r\n    background-color: #ecf5f1;\r\n    .card-body {\r\n      padding: 8px 10px;\r\n      p {\r\n        font-size: 18px;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CategoryEdit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CategoryEdit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CategoryEdit.vue?vue&type=template&id=068929a2&scoped=true&\"\nimport script from \"./CategoryEdit.vue?vue&type=script&lang=js&\"\nexport * from \"./CategoryEdit.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CategoryEdit.vue?vue&type=style&index=0&id=068929a2&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"068929a2\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}